generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model User {
  id          Int          @id @default(autoincrement())
  name        String
  email       String       @unique
  image       String?
  createdAt   DateTime     @default(now())
  photos      Photo[]
  collections Collection[]
}

model Photo {
  pid                    Int         @id @default(autoincrement())
  name                   String
  user                   User        @relation(fields: [uid], references: [id])
  uid                    Int
  collection             Collection? @relation(fields: [cid], references: [cid])
  thumbnailForCollection Collection? @relation("thumbnail")
  cid                    Int?
}

model Collection {
  cid          Int     @id @default(autoincrement())
  name         String
  user         User    @relation(fields: [uid], references: [id])
  uid          Int
  photos       Photo[]
  thumbnail    Photo?  @relation("thumbnail", fields: [thumbnailPid], references: [pid])
  thumbnailPid Int?    @unique
}
